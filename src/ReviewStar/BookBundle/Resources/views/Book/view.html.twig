{% extends "ReviewStarBookBundle::layout.html.twig" %}

{% block title %}
    {{ book.bookTitle }}
{% endblock %}

{% block body %}
    <h1>Viewing {{ book.bookTitle  }}</h1>
    <h4><strong>Average Rating: </strong>{{ book.getAverageRating()|number_format(1, '.', ',') }}</h4>
    <h4><strong>Author:</strong> {{ book.bookAuthor }}</h4>
    <h4><strong>Publisher:</strong> {{ book.bookPublisher }}</h4>
    <h4><strong>Year Published:</strong> {{ book.bookPublishDate|date("Y") }}</h4>
    <h4><strong>Synopsis:</strong> {{ book.bookSynopsis }}</h4>
    <img src="{{ asset('uploads/images/') ~ book.bookCover }}" alt="{{ book.bookTitle }}" class="img-thumbnail" height="500"/>
    <br />
    <br />
    {% if book.user == app.user %}
        <a href="{{ path('rs_book_edit', { id: book.id }) }}">Edit this book</a>
        <br />
        <a href="{{ path('rs_book_delete', { id: book.id }) }}">Delete</a>
    {% endif  %}
    <br />
    <br />
    {% if book.getReviews().count > 0 %}
        {% for review in book.getReviews() %}
            <div class="panel {{ review.getUser() == app.user ? 'panel-success' : 'panel-default'}}">
                <div class="panel-heading">
                    <p>{{ review.reviewTitle }}</p>
                </div>
                <div class="panel-body">
                    <p>{{ review.reviewContent }}</p>
                </div>
                <div class="panel-footer">
                    <p>{{ review.user }} rated this {{ review.reviewRating }} out of 5</p>
                    {% if review.user == app.user %}
                        <p><a href="{{ path("rs_review_edit", { 'bookId': book.id, 'id': review.id }) }}">Edit this review</a></p>
                        <p><a href="{{ path("rs_review_delete", { 'id': review.id }) }}">Delete this review</a></p>
                    {% endif %}
                </div>
            </div>
        {%  endfor %}
        <a href="{{ path("rs_review_create", {"bookId" : book.id }) }}">Write a new review</a>
    {% else %}
        <p>Currently empty, be the first to <a href="{{ path("rs_review_create", {"bookId" : book.id }) }}">write a review</a></p>
    {% endif %}
{% endblock %}